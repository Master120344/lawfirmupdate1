document.addEventListener('DOMContentLoaded', () => {
    const loader = document.getElementById('loader');
    const bodyElement = document.body;
    const menuButton = document.querySelector('.menu-button');
    const mobileNav = document.querySelector('.mobile-nav');
    const navLinks = document.querySelectorAll('.mobile-nav a');
    const testimonialSlider = document.querySelector('.testimonial-slider');
    let testimonialIndex = 0;

    // Fade out loader when the page is loaded
    if (bodyElement) {
        bodyElement.classList.add('loaded');
    } else {
        console.error("Body element not found.");
    }

    if (loader) {
        setTimeout(() => {
            loader.classList.add('hidden');
        }, 600); // Slightly longer for smoother perceived transition
    } else {
        console.error("Loader element not found.");
    }

    // Toggle mobile navigation
    if (menuButton && mobileNav) {
        menuButton.addEventListener('click', () => {
            mobileNav.style.display = mobileNav.style.display === 'block' ? 'none' : 'block';
            menuButton.classList.toggle('open');
        });

        // Close mobile nav when a link is clicked
        navLinks.forEach(link => {
            link.addEventListener('click', () => {
                mobileNav.style.display = 'none';
                menuButton.classList.remove('open');
            });
        });
    }

    // Basic testimonial slider functionality
    if (testimonialSlider) {
        const testimonials = testimonialSlider.children;
        if (testimonials.length > 0) {
            function showTestimonial(index) {
                for (let i = 0; i < testimonials.length; i++) {
                    testimonials[i].style.display = 'none';
                }
                testimonials[index].style.display = 'block';
            }

            showTestimonial(testimonialIndex); // Show the first testimonial initially

            setInterval(() => {
                testimonialIndex = (testimonialIndex + 1) % testimonials.length;
                showTestimonial(testimonialIndex);
            }, 5000); // Change testimonial every 5 seconds
        }
    }
});
